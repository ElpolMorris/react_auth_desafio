(this.webpackJsonpdesafio_auth=this.webpackJsonpdesafio_auth||[]).push([[0],{70:function(e,t,a){"use strict";a.r(t);var c=a(0),r=a.n(c),n=a(20),s=a.n(n),o=a(6),u=(a(46),a(13)),i=a(2),l=a(11),j=a.n(l),b=a(14),d=a(12),p=a(15),O=a.n(p),h=a(1),x=function(){return Object(h.jsx)("div",{className:"spinner-border mx-auto mt-5 text-primary",role:"status",children:Object(h.jsx)("span",{className:"sr-only ",children:"Loading..."})})},f=function(){var e=Object(c.useState)(""),t=Object(d.a)(e,2),a=t[0],r=t[1],n=Object(c.useState)(""),s=Object(d.a)(n,2),o=s[0],u=s[1],l=Object(c.useState)(localStorage.getItem("token")),p=Object(d.a)(l,2),f=p[0],v=p[1],m=Object(c.useState)(!1),g=Object(d.a)(m,2),S=g[0],y=g[1],E=Object(i.f)(),N=function(){var e=Object(b.a)(j.a.mark((function e(t){var c,r,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,O.a.post("http://localhost:4000/auth/login",{username:a,password:o});case 4:c=e.sent,r=c.data,n=r.jwt,localStorage.setItem("token",n),v(n),y(!1),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),y(!0);case 15:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}();return Object(c.useEffect)((function(){f&&E.push("/dashboard")}),[E,f]),f?Object(h.jsx)(x,{}):Object(h.jsx)(h.Fragment,{children:Object(h.jsxs)("form",{className:"col-4 mx-auto",onSubmit:function(e){return N(e)},children:[Object(h.jsx)("h3",{className:"text-center",children:"Ingrese sus credenciales"}),Object(h.jsxs)("div",{className:"p-1 row",children:[Object(h.jsx)("label",{className:"col-4",children:"Usuario"}),Object(h.jsx)("input",{className:"col-8",type:"text",onChange:function(e){return r(e.target.value)}})]}),Object(h.jsxs)("div",{className:"p-1 row",children:[Object(h.jsx)("label",{className:"col-4",children:"Contrase\xf1a"}),Object(h.jsx)("input",{className:"col-8",type:"password",onChange:function(e){return u(e.target.value)}})]}),Object(h.jsx)("div",{className:"row pt-1",children:Object(h.jsx)("button",{type:"submit",className:"col-12 btn btn-primary btn-lg btn-block",children:"Ingresar"})}),S&&Object(h.jsx)("p",{className:"text-danger",children:"usuario o contrase\xf1a err\xf3neos"})]})})},v=function(){return Object(h.jsx)("div",{className:"row",children:Object(h.jsx)(f,{})})},m="GET_USERS_INIT",g="GET_USERS_SUCCCESS",S="GET_USERS_FAILURE",y="USER_DELETE_INIT",E="USER_DELETE_SUCCESS",N="USER_DELETE_FAILURE",w="USER_UPDATE_INIT",C="USER_UPDATE_SUCCESS",U="USER_CREATE_INIT",k="USER_CREATE_SUCCESS",_="USER_CREATE_FAILURE",I=a(17),R=a(37),T=a(38),L=a(27),D=a(4),A={isLogin:!1,data:[],errorMessagge:""},F=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:A,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case m:return Object(D.a)({},e);case g:var a=t.payload.filter((function(e){return e.id>6}));return Object(D.a)(Object(D.a)({},e),{},{isLogin:!0,data:Object(L.a)(a)});case S:return Object(D.a)(Object(D.a)({},e),{},{errorMessagge:t.payload,data:[],isLogin:!1});case y:return Object(D.a)({},e);case E:return Object(D.a)(Object(D.a)({},e),{},{data:t.payload});case N:return Object(D.a)(Object(D.a)({},e),{},{errorMessagge:t.payload});case U:return Object(D.a)({},e);case k:return Object(D.a)(Object(D.a)({},e),{},{data:[].concat(Object(L.a)(e.data),[t.payload])});case _:return Object(D.a)(Object(D.a)({},e),{},{errorMessagge:t.payload});case w:return Object(D.a)({},e);case C:return Object(D.a)(Object(D.a)({},e),{},{data:t.payload});default:return e}},B=Object(I.combineReducers)({users:F}),M=Object(I.createStore)(B,Object(R.composeWithDevTools)(Object(I.applyMiddleware)(T.a))),z=function(e){return{type:g,payload:e}},P=function(e){var t=M.getState().users.data;return{type:E,payload:t.filter((function(t){return t.id!==+e}))}},G=function(e){return{type:k,payload:e}},J=function(e){var t=M.getState().users.data,a=t.findIndex((function(t){return t.id===+e.id}));return t[a]=e,{type:C,payload:t}},W=function(e){return function(){var t=Object(b.a)(j.a.mark((function t(a){var c,r;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a({type:m}),t.prev=1,t.next=4,O.a.get("http://localhost:4000/products",{headers:{authorization:"Bearer ".concat(e)}});case 4:c=t.sent,r=c.data,a(z(r)),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),console.log(t.t0.message),a((n=t.t0.message,{type:S,payload:n}));case 13:case"end":return t.stop()}var n}),t,null,[[1,9]])})));return function(e){return t.apply(this,arguments)}}()},q=function(){var e=Object(o.c)((function(e){return e.users.data})),t=Object(o.c)((function(e){return e.users.isLogin})),a=Object(o.b)();Object(i.f)();return Object(c.useEffect)((function(){var e,t=null!==(e=localStorage.getItem("token"))&&void 0!==e?e:"";a(W(t))}),[]),t?Object(h.jsxs)("div",{children:[Object(h.jsx)("h1",{children:"Dashboard"}),Object(h.jsx)("button",{className:"btn-success",children:Object(h.jsx)(u.b,{className:"text-white",to:"/dashboard/create",children:"Crear usuario"})}),Object(h.jsx)("div",{children:e.map((function(e){return Object(h.jsxs)("div",{children:[Object(h.jsx)("span",{children:e.id}),Object(h.jsx)("span",{children:e.username}),Object(h.jsx)("button",{className:"btn btn-warning",children:Object(h.jsx)(u.b,{className:"text-dark",to:"/dashboard/update/".concat(e.id),children:"Editar"})}),Object(h.jsx)("button",{className:"btn btn-danger",children:Object(h.jsx)(u.b,{className:"text-white",to:"/dashboard/delete/".concat(e.id),children:"Borrar"})})]},e.id)}))})]}):Object(h.jsx)(x,{})},H=function(){var e=Object(i.f)();return Object(h.jsx)("div",{children:Object(h.jsx)(u.b,{to:"/",onClick:function(){localStorage.clear(),e.replace("/")},children:"Cerrar sesi\xf3n"})})},K=function(){var e=Object(i.g)().id,t=Object(o.b)(),a=Object(i.f)();return Object(h.jsxs)("div",{children:[Object(h.jsx)("p",{children:"\xbfEst\xe1 seguro de borrar este usuario?"}),Object(h.jsxs)("div",{children:[Object(h.jsx)("button",{onClick:function(){var c,r=null!==(c=localStorage.getItem("token"))&&void 0!==c?c:"";t(function(e,t){return function(){var a=Object(b.a)(j.a.mark((function a(c){return j.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return c({type:y}),a.prev=1,a.next=4,O.a.delete("http://localhost:4000/products/".concat(e),{headers:{authorization:"Bearer ".concat(t)}});case 4:a.sent.data,c(P(e)),a.next=12;break;case 9:a.prev=9,a.t0=a.catch(1),c((r=a.t0.message,{type:N,payload:r}));case 12:case"end":return a.stop()}var r}),a,null,[[1,9]])})));return function(e){return a.apply(this,arguments)}}()}(e,r)),a.replace("/dashboard")},children:"Borrar"}),Object(h.jsx)("button",{onClick:function(){a.push("/dashboard")},children:"Cancelar"})]})]})},Q=function(){Object(o.c)((function(e){return e.users.data}));var e=Object(c.useState)(""),t=Object(d.a)(e,2),a=t[0],r=t[1],n=Object(c.useState)(""),s=Object(d.a)(n,2),u=s[0],l=s[1],p=Object(o.b)(),x=Object(i.f)();Object(c.useEffect)((function(){var e,t=null!==(e=localStorage.getItem("token"))&&void 0!==e?e:"";p(W(t))}),[]);var f=function(e){var t;e.preventDefault();var c=null!==(t=localStorage.getItem("token"))&&void 0!==t?t:"";p(function(e,t){return function(){var a=Object(b.a)(j.a.mark((function a(c){return j.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return c({type:U}),a.prev=1,a.next=4,O.a.post("http://localhost:4000/products",e,{headers:{authorization:"Bearer ".concat(t)}});case 4:a.sent.data,c(G(e)),a.next=13;break;case 9:a.prev=9,a.t0=a.catch(1),console.log(a.t0),c((r=a.t0.message,{type:_,payload:r}));case 13:case"end":return a.stop()}var r}),a,null,[[1,9]])})));return function(e){return a.apply(this,arguments)}}()}({username:a,password:u},c)),x.push("/dashboard")};return Object(h.jsxs)("div",{children:[Object(h.jsx)("h1",{children:"Crear Usuario"}),Object(h.jsxs)("form",{onSubmit:function(e){return f(e)},children:[Object(h.jsxs)("div",{className:"p-1 row",children:[Object(h.jsx)("label",{className:"col-4",children:"Usuario"}),Object(h.jsx)("input",{className:"col-8",value:a,onChange:function(e){return r(e.target.value)},type:"text"})]}),Object(h.jsxs)("div",{className:"p-1 row",children:[Object(h.jsx)("label",{className:"col-4",children:"Contrase\xf1a"}),Object(h.jsx)("input",{className:"col-8",value:u,onChange:function(e){return l(e.target.value)},type:"password"})]}),Object(h.jsx)("div",{className:"row pt-1",children:Object(h.jsx)("button",{type:"submit",className:"col-12 btn btn-primary btn-lg btn-block",children:"Crear"})})]})]})},V=function(){var e=Object(o.c)((function(e){return e.users.data})),t=Object(c.useState)(""),a=Object(d.a)(t,2),r=a[0],n=a[1],s=Object(c.useState)(""),u=Object(d.a)(s,2),l=u[0],p=u[1],x=Object(i.f)(),f=Object(i.g)().id,v=Object(o.b)();Object(c.useEffect)((function(){var t=e.filter((function(e){return e.id===+f}))[0],a=t.username,c=t.password;n(a),p(c)}),[]);var m=function(e){var t;e.preventDefault();var a=null!==(t=localStorage.getItem("token"))&&void 0!==t?t:"";v(function(e,t){return function(){var a=Object(b.a)(j.a.mark((function a(c){return j.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return c({type:w}),a.prev=1,a.next=4,O.a.put("http://localhost:4000/products/".concat(e.id),{username:e.username,password:e.password},{headers:{authorization:"Bearer ".concat(t)}});case 4:a.sent.data,c(J(e)),a.next=14;break;case 10:a.prev=10,a.t0=a.catch(1),console.log(a.t0),c({type:"USER_UPDATE_FAILURE",payload:a.t0.message});case 14:case"end":return a.stop()}}),a,null,[[1,10]])})));return function(e){return a.apply(this,arguments)}}()}({id:+f,username:r,password:l},a)),x.push("/dashboard")};return Object(h.jsxs)("form",{onSubmit:function(e){return m(e)},children:[Object(h.jsxs)("div",{className:"p-1 row",children:[Object(h.jsx)("label",{className:"col-4",children:"Usuario"}),Object(h.jsx)("input",{className:"col-8",type:"text",value:r,onChange:function(e){return n(e.target.value)}})]}),Object(h.jsxs)("div",{className:"p-1 row",children:[Object(h.jsx)("label",{className:"col-4",children:"Contrase\xf1a"}),Object(h.jsx)("input",{className:"col-8",type:"password",value:l,onChange:function(e){return p(e.target.value)}})]}),Object(h.jsx)("div",{className:"row pt-1",children:Object(h.jsx)("button",{type:"submit",className:"col-12 btn btn-primary btn-lg btn-block",children:"Actualizar"})})]})};var X=function(){return Object(h.jsx)(u.a,{children:Object(h.jsxs)(i.c,{children:[Object(h.jsxs)(i.a,{path:"/dashboard",exact:!0,children:[Object(h.jsx)(H,{}),Object(h.jsx)(q,{})]}),Object(h.jsxs)(i.a,{path:"/dashboard/create",exact:!0,children:[Object(h.jsx)(H,{}),Object(h.jsx)(Q,{})]}),Object(h.jsxs)(i.a,{path:"/dashboard/update/:id",children:[Object(h.jsx)(H,{}),Object(h.jsx)(V,{})]}),Object(h.jsxs)(i.a,{path:"/dashboard/delete/:id",children:[Object(h.jsx)(H,{}),Object(h.jsx)(K,{})]}),Object(h.jsx)(i.a,{path:"/",exact:!0,children:Object(h.jsx)(v,{})})]})})},Y=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,71)).then((function(t){var a=t.getCLS,c=t.getFID,r=t.getFCP,n=t.getLCP,s=t.getTTFB;a(e),c(e),r(e),n(e),s(e)}))};s.a.render(Object(h.jsx)(r.a.StrictMode,{children:Object(h.jsx)(o.a,{store:M,children:Object(h.jsx)(X,{})})}),document.getElementById("root")),Y()}},[[70,1,2]]]);
//# sourceMappingURL=main.d933b8a0.chunk.js.map